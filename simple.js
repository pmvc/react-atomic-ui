!function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(e,t,n){"use strict";n.r(t);var r=function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},i="undefined",o=undefined,a=Object.keys,c=Array.isArray,u="|number|boolean|string|object|function|"+i+"|",s=function toBase(e,t){return-1===u.indexOf("|"+e+"|")?(t||(t=e),t):e},f=function getTypeIs(e,t){var n=Object.prototype.toString.call(e).replace(/^\[object\s(.*)\]$/,"$1").toLowerCase();return s(n,t)},l=function getTypeOf(e,t){if(null==e)return f(e,t);try{var n=Object.getPrototypeOf(e).constructor.name.toLowerCase();return s(n,t)}catch(r){return f(e,t)}};function _objectSpread2(e){for(var t=1,n=arguments.length;t<n;t++)if(t%2||!Object.getOwnPropertyDescriptors){var i=null!=arguments[t]?arguments[t]:{},o=a(i);"function"===l(Object.getOwnPropertySymbols)&&(o=o.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),o.forEach((function(t){r(e,t,i[t])}))}else Object.defineProperties(e,Object.getOwnPropertyDescriptors(arguments[t]));return e}var p=function getDateObject(e){return null!=e?new Date(e):new Date},d=function getTimestamp(e){return+p(e)},g=function getRandom(){return d()+""+Math.random()},m=d(),v=function classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},h=function defineProperties(e,t){for(var n=0,r=t.length;n<r;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}},y=function createClass(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e},_=function replaceValue(e,t,n,r,i){if(!i&&function isPrototypePolluted(e){var t="|".concat(e.join("|"),"|");return["__proto__","constructor","prototype"].some((function(e){return-1!==t.indexOf("|".concat(e,"|"))}))}(t))throw"Contain un-safe key.";var o=t.pop(),a=e;t.forEach((function(e){var t;a[e]=null!==(t=a[e])&&void 0!==t?t:Object.create(null),a=a[e]})),!r||a[o]&&a[o].push?r&&a[o].push?a[o].push(n):a[o]=n:a[o]?a[o]=[a[o],n]:a[o]=[n]},b=function _typeof(e){return"symbol"===l(e)?"symbol":l(e,"object")},S=function getDefaultValue(e,t){return"function"===b(e)?e(t):null!=e?e:t},k=function toJS(e){return e&&e.toJS?e.toJS():e},w=function toMap(e,t){var n=I(e,t,{}),r={};return a(n).forEach((function(e){return r[e]=k(n[e])})),r},I=function get(e,t,n){if(null==e)return S(n,e);var r=k(e);if(!t||!c(t))return r;try{for(var o=t.length,a=t.length-1;o--;){var u=t[a-o];if(!r||i===b(r[u])){r=S(n);break}if(null==(r=r[u])){r=S(n,r);break}}}catch(s){console.warn({e:s}),r=S(n)}return r},j=I,A=function callFunc(e,t,n,r){return"function"===b(e)?e.apply(n,t):i!==b(r)?r:e},O=function getParams(e){return j(e,["params"],{})},x=function(){function BaseI13nReducer(){v(this,BaseI13nReducer)}return y(BaseI13nReducer,[{key:"sendBeacon",value:function sendBeacon(e,t){return e}},{key:"initDone",value:function initDone(e,t){var n=this,r=t||{},i=r.triggerImpression,o=r.asyncInit,a=function assignState(e){return e.set("init",!0).set("nextEmit","init")};return!o&&this.dispatch(a(e)),setTimeout((function(){i?i((function(){return n.dispatch("impression")})):n.dispatch("impression")})),o?a(e):e}},{key:"processImpression",value:function processImpression(e,t){return this.sendBeacon(e,t)}},{key:"processAction",value:function processAction(e,t){var n=e.get("vpvid");return n&&_(t,[PARAMS,"query","vpvid"],n),this.sendBeacon(e,t)}},{key:"handleInit",value:function handleInit(e,t){var n=e.get("initHandler"),r=this.initDone.bind(this);return n||(t.asyncInit=!0),A(n||r,[e,t,r])}},{key:"handleImpression",value:function handleImpression(e,t){var n=this;return e.get("init")?e.get("disableHandleImpression")?e:function maybeAsyncRun(e){var r=e.get("impressionHandler"),i=A(r||n.processImpression.bind(n),[e,t]);return O(t).stop||(i=i.set("nextEmit","impression")),i}(e):this.handleInit(e,t)}},{key:"handleAction",value:function handleAction(e,t){var n=e.get("actionHandler"),r=A(n||this.processAction.bind(this),[e,t]),i=O(t),o=i.wait,a=i.stop;return null!=o||a||(r=r.set("nextEmit","action")),r}},{key:"mergeMap",value:function mergeMap(){throw"abstract method"}},{key:"reduce",value:function reduce(e,t){switch(e.get("nextEmit")&&(e=e.set("nextEmit",null)),t.type){case"impression":return this.handleImpression(e,t);case"action":return this.handleAction(e,t);case"config/set":return this.mergeMap(e,t.params);case"reset":return this.mergeMap(this.store.reset(),t.params);default:return a(t).length?this.mergeMap(e,t):e}}}]),BaseI13nReducer}(),E=Object.assign||function(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},C=function objectWithoutProperties(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},D=Object.keys,P=function(){function Storage(e){v(this,Storage),this._storage=e}return y(Storage,[{key:"set",value:function set(e,t){var n=JSON.stringify(k(t)),r=n.length+","+n;return this._storage(e)(r),new Storage(this._storage)}},{key:"merge",value:function merge(e){var t=this;if(!e||"object"!==b(e))return this;var n=D(e);return n&&n.length?(n.forEach((function(n){return t.set(n,e[n])})),new Storage(this._storage)):this}},{key:"get",value:function get(e){var t=this._storage(e)();if(t){var n=t.indexOf(","),r=function toInt(e){return parseInt(e,10)}(t.substring(0,n)),i=t.substr(n+1);return r===i.length?JSON.parse(i):null}}}]),Storage}(),T={__null:!0},M=function doc(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:T;return e=e||N(),i!==b(e.document)?e.document:t},N=function win(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:T;return"undefined"!=typeof window?window:e},z={},q=function getStorage(e){return function(t){return function(n){var r=N();if(r&&!z[e]){var o=j(r,[e]);if(i===b(o))return console.warn("Not support. ["+e+"]"),void(z[e]=!0);if(i===b(n))return o.getItem(t);try{return null==n?o.removeItem(t):o.setItem(t,n)}catch(a){return o.clear(),o.setItem(t,n)}}}}},L=q("localStorage"),R=(q("sessionStorage"),function getTime(e){var t=p(e),n=[t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()].map((function(e){return function fixDigit(e){return e<10?"0"+e:e}(e)}));return{toArray:function toArray(){return n},toString:function toString(){return[n.slice(0,3).join("-"),"T",n.slice(3).join(":"),"Z"].join("")}}}),U=["stop","wait","lazeInfo","lazyKey"],H=function docUrl(){return M().URL},F=function processLazyAction(e,t){var n=function processLazy(e,n){var r=e[n],o=O(r),a=o.wait,c=o.stop;return!a||a<=0?(c||(i!==b(j(r,["params","wait"]))&&delete r.params.wait,t&&t(r)),delete e[n]):r.params.wait=function _readOnlyError(e){throw new Error('"'+e+'" is read-only')}("wait"),e[n]},r=j(e,["__seq"]);c(r)&&(e.__seq=r.filter((function(e,t){return n(r,t)})));var o=j(e,["__hash"]);return o&&a(o).forEach((function(e){return n(o,e)})),e},J=function getDefaultStorage(){return new P(L)};function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){var n=[];return a(e).some((function(r,i){if(n.push(e[r]),t===i+1)return!0})),n}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var B=function toConsumableArray(e){if(Array.isArray(e)||!Array.from){for(var t=0,n=Array(e.length),r=e.length;t<r;t++)n[t]=e[t];return n}return Array.from(e)},V=function emitter(){var e=[];return{reset:function reset(){return e.splice(0,e.length)},add:function add(t){return e.unshift(t)},remove:function remove(t){return e.splice(e.indexOf(t)>>>0,1)},emit:function emit(t,n,r){return setTimeout((function(){for(var i=e.length;i--;){var o=e[i];o&&o(t,n,r)}}))}}},G=function refineAction(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=arguments.length>1?arguments[1]:undefined;return e.trim&&(e={type:e},t&&(e.params=t)),e},K=function(){function SimpleMap(e){v(this,SimpleMap),r(this,"_state",{}),e&&(this._state=e)}return y(SimpleMap,[{key:"get",value:function get(e){return"object"===b(this._state[e])&&null!==this._state[e]?new SimpleMap(this._state[e]):this._state[e]}},{key:"set",value:function set(e,t){var n=_objectSpread2(_objectSpread2({},this._state),{},r({},e,k(t)));return this._state=n,new SimpleMap(n)}},{key:"delete",value:function _delete(e){var t=_objectSpread2({},this._state);return delete t[e],this._state=t,new SimpleMap(t)}},{key:"merge",value:function merge(e){var t=_objectSpread2(_objectSpread2({},this._state),k(e));return this._state=t,new SimpleMap(t)}},{key:"toJS",value:function toJS(){return this._state}}]),SimpleMap}(),W=(Object.keys,!1),X=0,$=function logError(e,t,n){if(5===X)console.log("Max Errors exceed.",5);else if(X>5)return;X++;var r=e||{},i=r.message,o=(r.stack,{message:i,stack:j(e,["stack"],"").split(/\n/),url:M().URL,lastExec:void 0});if(n&&(o.name=n),setTimeout((function(){var e=t&&-1!==t.indexOf("I13nScriptErr")?0:undefined;te("action",{wait:e,I13N:{action:t,category:"Error",label:o}})})),W)throw console.error({action:t,name:n},void 0),e},Q=JSON,Y=new x,Z=_slicedToArray(function createReducer(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},n={current:A(t)},r=V(),a=function dispatch(){for(var t=arguments.length,a=new Array(t),c=0;c<t;c++)a[c]=arguments[c];a=G.apply(void 0,B(a));var u=n.current,s=e(u,a);if(s===o)throw console.trace(),"reduce() return ".concat(i,".");u!==s&&(n.current=s,r.emit(s,a,u))},c={reset:function reset(){return r.reset()&&A(t)},getState:function getState(){return n.current},addListener:r.add,removeListener:r.remove};return[c,a]}(Y.reduce.bind(Y),new K),2),ee=Z[0],te=Z[1],ne=function mergeMap(e,t){return e.merge(t)};(function i13nStoreReAssign(e){var t=e.oI13n,n=e.store,r=e.i13nDispatch,i=e.mergeMap;t.store=n,t.dispatch=r,t.mergeMap=i,n.i13n=t})({oI13n:Y,store:ee,i13nDispatch:te,mergeMap:ne}),ee.getClone=function(e){return function clone(e){try{return Q.parse(Q.stringify(e))}catch(t){$(t,"I13nScriptErr")}}(w(ee.getState().get(e)))},Array.isArray,Object.keys;var re,ie,oe=Object.keys,ae=Array.isArray,ce=function removeEmpty(e,t,n){if(!e)return e;t&&"function"!==b(t)&&(t=function undefinedOnly(e){return i!==b(e)});var r={};return oe(e).forEach((function(i){var o=e[i];n&&n.length&&-1!==n.indexOf(i)||(o||t&&t(o))&&(r[i]=o)})),ae(e)?oe(r).map((function(e){return r[e]})):r},ue=new K,se=new K,fe=function lazyAttr(e,t){return function(n){var r=w(ue.get("i13nLazyAttr"));if(i===b(e))return r;var o=w(ue.get("i13nLazyExpire")),a=d();return i!==b(n)&&(r[e]=n,o[e]=a,ue.set("i13nLazyAttr",r),ue.set("i13nLazyExpire",o)),function expireCallback(e,t,n,r){var i=d(),o=!1;return null==e||isNaN(e)||(!t||i-e<=t)&&(o=!0),A(o?n:r)}(o[e],t?1e3*t:null,(function(){return r[e]}))}},le=fe("__prods"),pe=function forEachStoreProducts(e){var t=function getAllLazyProducts(){return w(le())}();return["impressions","detailProducts","products"].forEach((function(n){var r=c(e[n])?e[n]:function objectToArray(e){return a(e||{}).map((function(t){return e[t]}))}(e[n]);r.length?function storeProducts(e,t){e.forEach((function(n,r){n&&n.id&&(t[n.id]=_objectSpread2(_objectSpread2({},t[n.id]),ce(n)),delete t[n.id].quantity,delete t[n.id].variant,delete t[n.id].position,e[r]=_objectSpread2(_objectSpread2({},n),t[n.id]))}))}(r,t):delete e[n]})),le(t),e},de=function lazyProducts(e){var t=pe(w(e.get("I13N"))),n=pe(w(e.get("i13nPage")));return e.set("I13N",t).set("i13nPage",n)},ge=function workerUtils(){return{dispatch:te}},me=function getGaHost(){return"https://www.google-analytics.com/".concat(function getDebugFlag(){return W}()?"debug/":"","collect")},ve=[{},[]],he=function initLazyAction(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:J(),t=function getAllLazy(){return w(e.get("lazyAction"))},n=function getOneLazy(e){return w(t().__hash)[e]},r=function updateLazy(t){return e.set("lazyAction",t)},i=function removeLazy(e){var n=t();j(n,["__hash",e])&&(delete n.__hash[e],r(n))},o=function getActionMergeWithLazy(e,n){var r=t(),i=j(r,["__hash",n,"params"],{}),o=(i.stop,i.wait,i.lazeInfo,i.lazyKey,C(i,U));return a(o).forEach((function(t){var n=o[t],r="object"===b(n)?_objectSpread2(_objectSpread2({},n),j(e,["params",t],{})):j(e,["params",t],n);_(e,["params",t],r)})),delete e.params.withLazy,e},c=function pushLazyAction(e,n){var i=O(e),o={params:E({},i),type:e.type};_(o,["params","lazeInfo"],{from:H(),time:R().toString()});var a=t();n?_(a,["__hash",n],o):_(a,["__seq"],o,!0),r(a)},u=function process(e){return r(F(t(),e))},s=function handleAction(e,t){var n=O(t).withLazy;n&&(t=o(t,n));var r=e.get("lazyActionHandler"),a=A(r,[e,t])||e,c=O(t),u=c.wait,s=c.stop,f=c.lazyKey;return null!=u||s||n&&n!==f&&i(n),a};return{process:u,handleAction:s,getAll:t,getOne:n,push:c}}(se),ye=function maybeDelayAction(e,t){return function(){e.get("init")||_(t,["params","wait"],0);var n=_slicedToArray(function getCbParams(){return ve}(),2),r=n[0],o=n[1],a=o[0],c=o[1],u=O(t);isNaN(u.delay)||delete t.params.delay;var s,f,l=u.i13nCb,p=u.lazeInfo,d=u.i13nPageCb,g=u.wait,m=u.lazyKey,v=u.I13N;if(p&&(v.lazeInfo=p),"function"===b(l)&&(r.currentTarget=null!==(s=r.currentTarget)&&void 0!==s?s:c,v=l(a,null!==(f=v)&&void 0!==f?f:{},r,e),delete t.params.i13nCb),v=function oneTimeAction(e,t){var n=t&&t.get("oneTimeAction"),r=e&&e.action;if(r&&n&&n.length){var i=fe("oneTimeAction"),o=i()||{};if(o[r])return!1;-1!==n.indexOf(r)&&(o[r]=!0,i(o))}return e}(v,e),e=e.set("I13N",v),v?i!==b(g)&&(_(t,["params","I13N"],pe(v)),he.push(t,m)):_(t,["params","stop"],!0),"function"===b(d)){var h=d(t,v,r);if(h){var y=e.get("i13nPage");e=e.set("i13nPage",y?y.merge(h):h)}}return de(e)}},_e=function actionHandler(e,t){var n=O(t),r=n.delay,o=n.wait,c=ye(e,t);return isNaN(r)?e=c():(setTimeout((function(){var e=c();e&&te(e);var t=e.get("I13N");i===b(o)&&a(t.toJS()).length&&te("action",{I13N:t})}),r),_(t,["params","stop"],!0)),e},be=function heeding(e,t){return function(n,r){n.get("nextEmit")===t&&A(e)}},Se=/[|\\{}()[\]^$+*?.]/g,ke=function cacheReg(e){return function(t,n){return function(r){if(!e[r]){var i=t?t(r):r;e[r]=new RegExp(i,n)}return e[r]}}},we=function getSafeReg(e){return function text(e){return e?e+"":""}(e).replace(Se,"\\$&")},Ie=function getRegString(e){return"(([#?&])"+we(e)+"=)([^&#]*)"},je=ke({})(Ie),Ae=ke({})(Ie,"g"),getKeyReg=function(e){return je(e)},Oe=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,xe={},Ee=o,Ce=function parseUrl(e){var t=function getUrlAnaly(e){return xe[e]||(xe[e]=Oe.exec(e)),xe[e]}(e);return{host:t[11],query:t[16],path:t[13]}},De=function resetUrl(e){return e||M().URL},Pe=function getUrl(e,t){var n=Ce(De(t)).query,r=void 0===n?"":n,i=function getOne(e){var t=e+"=";if(r.indexOf(t)===r.lastIndexOf(t)){var n=getKeyReg(e).exec(r);return n?decodeURIComponent(n[3]):Ee}return function oneItemArrayToString(e){return c(e)?e.length>1?e:e[0]:e}(Te(e,r))};if(c(e)){var o={};return e.forEach((function(e){o[e]=i(e)})),o}return e?i(e):Ee},Te=function getUrlArray(e,t){var n=Ce(De(t)).query;return function getMultiKey(e,t){for(var n,r=function getMultiMatchReg(e){return Ae(e)}(e),i=[];n=r.exec(t);)i.push(decodeURIComponent(n[3]));return i}(e,void 0===n?"":n)},Me=["Shopify","Checkout"],Ne=function getStepName(){return j(N(),[].concat(Me,["step"]))},ze=function getDocUrl(){var e=j(N(),["__st","pageurl"]);if(e)return"https://"+e},qe=function getStepNo(){switch(Ne()){default:break;case"contact_information":return 1;case"shipping_method":return 2;case"payment_method":return 3}},Le=Ne,Re=function getShopId(){return j(N(),["Shopify","shop"],(function(){return j(N(),[].concat(Me,["apiHost"]))}))},Ue=function getPage(){if("thank_you"===Ne())return"thank_you";var e=N();return j(e,["__st","t"],(function(){return j(e,["__st","p"])}))},He=function getUid(){return j(N(),["__st","cid"])},Fe=function getGaId(){var e=ze(),t=Pe("_ga",e)||"";return j(t.split("-"),[1])},Je=ze,Be=function getCurrency(){return j(N(),[].concat(Me,["currency"]),(function(){return j(N(),["Shopify","currency","active"])}))},Ve=function getClientId(){var e=j(N(),[].concat(Me,["token"]));if(e)return"shopify-checkout-"+e},Ge=function setCurrency(e,t,n){var r=j(e,["currencyCode"])||n;_(t,["currencyCode"],r)},Ke={},We=function handleStep(e,t,n){var r=e.stepNo,i=e.stepOption,o=e.products,a=null!=r?r:qe(),c=null!=i?i:Le();if(a){var u={step:a,option:c};!Ke[a]||o&&o.length||!c?(Ke[a]={actionField:u,products:o},Ge(e,t,n),_(t,["checkout"],Ke[a])):_(t,["checkout_option"],{actionField:u})}},Xe=function handlePromotionImpressions(e,t){var n=e.promotions;n&&_(t,["promoView","promotions"],n)},$e=function handleDetailProducts(e,t,n){var r=e.fromP,i=e.detailProducts;i&&(r&&_(t,["detail","actionField","list"],r),Ge(e,t,n),_(t,["detail","products"],i))},Qe=function handleImpressions(e,t,n){var r=e.p,i=e.impressions;i&&(Ge(e,t,n),r&&i.forEach((function(e,t){return i[t].list=e.list||r})),_(t,["impressions"],i))},Ye=function handlePurchase(e,t,n,r){var i=e.purchaseId,o=e.refundId,a=e.products,c=j(e,["affiliation"],""),u=j(e,["coupon"],""),s=j(e,["revenue"],0),f=j(e,["tax"],0),l=j(e,["shipping"],0);i&&(Ge(e,t,n),_(t,["purchase","actionField"],{id:i,affiliation:c,revenue:s,tax:f,shipping:l,coupon:u}),_(t,["purchase","products"],a)),o&&(_(t,["refund","actionField","id"],o),a&&(Ge(e,t,n),_(t,["refund","products"],a)))},Ze=function getActionEcommerce(e,t){var n,r,i=t.defaultCurrencyCode,o=e.p,a=e.action,c=e.products,u=e.promotions,s={};o&&(r={list:o});var f={actionField:r,products:c};switch(a){case"ClickPromotion":s.promoClick={promotions:u};break;case"ClickProduct":s.click=f,n=j(c,[0,"price"]),Ge(e,s,i);break;case"BuyNow":case"AddToCart":s.add=f,Ge(e,s,i);break;case"RemoveFromCart":s.remove=f,Ge(e,s,i);break;case"ViewContent":Xe(e,s),$e(e,s,i),Qe(e,s,i)}return We(e,s,i),Ye(e,s,i),{ecommerce:s,value:n}},et=function getImpressionEcommerce(e,t){var n=t.defaultCurrencyCode,r={};return Xe(e,r),$e(e,r,n),Qe(e,r,n),Ye(e,r,n),We(e,r,n),{ecommerce:r}},tt=function handleEcommerce(e,t,n){var r=n.getState(),o=A("action"===e.trigger?Ze:et,[t,{defaultCurrencyCode:r.get("currencyCode")}]),c=o.ecommerce,u=o.value;return a(c).length&&(e.ecommerce=c,"action"===e.trigger&&(e.category="Ecommerce",i!==b(e.value)||isNaN(u)||(e.value=u))),e},nt="|number|".concat("string","|"),rt=function toNum(e){if(i===b(e))return 0;if(-1!==nt.indexOf("|"+b(e)+"|")&&e){var t=e&&e.trim?e.trim():e+"",n=parseFloat(t),r=parseInt(t,10);if(n!==r||r+""!==t&&0!==r){if(t===n+"")return n;var o=0;return-1!==t.indexOf(".")?n:(isNaN(t)||(o=t),console.warn("Can not change to number well.",{willNum:o,maybeString:t,num:e}),o)}return r}var a=Number(e);return isNaN(a)?0:a},it=/(\-)?(\d+)(\.)?(\d+)?/g,ot=function getNum(e){if("string"!==b(e))return rt(e);var t=e.replace(",","").match(it);return t?rt(t[0]):(console.warn("Get number fail",e),0)},at=!0,ct=ke({})((function getRegString(e){return"(?:^|;)\\s?"+we(e)+"=([^;]+)"})),ut=function notSupport(e){console.warn("cookie not support",{e:e}),at=!1},st=function getCookie(e,t){t=function docCookie(e){if(e)return e;if(!at)return"";try{return M().cookie}catch(t){return ut(t),""}}(t);var n=function getCookieReg(e){return ct(e)}(e).exec(t);return null!==n?decodeURIComponent(n[1]):null},ft=function getDocUrl(e){return j(e,["location"],(function(){return Je()||M().URL}))},lt=ft,pt=function getClientIdCookie(e){var t=(st(e||"")||"").split(".");if(t[2]&&t[3])return t[2]+"."+t[3]},dt=function getClientId(){return Ve()||function getCookieClientId(){var e=pt("_ga");return e||function setCookie(e,t,n,r){if(at)try{M().cookie=function getCookieSetStr(e,t,n,r){r=r||"";var i="";if(n=n||0){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),i="expires="+o.toUTCString()+";"}return r&&(r="domain="+r+";"||!1),e+"="+t+";"+i+r+"path=/"}(e,t,n,r)}catch(i){ut(i)}}("_ga","GA1.3."+(e=g()),730),e}()},gt=["id","name","category","brand","variant","position","price","quantity","coupon","image","sku"],mt=["list"],vt=function isArray(e){return e&&Array.isArray(e)&&e.length},ht=function notUndefinedNum(e){return i!==b(e)?ot(e):e},yt=function(){function DataLayerToMp(){var e=this;v(this,DataLayerToMp),r(this,"isSameHost",(function(e){return function(t){var n="//"+e,r=t.indexOf(n);if(5===r||6===r){var i=t.charAt(r+n.length);if("/"===i||"?"===i||""===i||":"===i)return!0}return!1}})),r(this,"getPromotionsData",(function(t){return e.getItemsData(t,"promo",e.setOnePromotion)})),r(this,"setOnePromotion",(function(e,t,n,r){var i=n.id,o=n.name,a=n.creative,c=n.position;t[e+"id"]=i,t[e+"nm"]=o,t[e+"cr"]=a,t[e+"ps"]=ht(c)})),r(this,"getProductsData",(function(t,n){return e.getItemsData(t,"pr",e.setOneProduct,n)}))}return y(DataLayerToMp,[{key:"getReferrer",value:function getReferrer(e){e||(e=M());var t=function getHostName(e){return Ce(ft(e)).host}(),n=j(e,["referrer"]);if(n&&!this.isSameHost(t)(n))return{dr:n}}},{key:"getActionData",value:function getActionData(e){var t=e||{},n=t.action,r=t.category,i=t.label,o=t.value;return{ec:r,ea:n,el:i,ev:ht(o)}}},{key:"getItemsData",value:function getItemsData(e,t,n,r){if(vt(e)){var i=1,o={};return e.forEach((function(e){if(e){var a=t+i;i++,A(n,[a,o,e,r])}})),o}}},{key:"getEcPromotionData",value:function getEcPromotionData(e,t){if(e||t){var n=(e||t).promotions;return _objectSpread2({promoa:e?"view":"click"},this.getPromotionsData(n))}}},{key:"setOneProduct",value:function setOneProduct(e,t,n,r){var i=n.id,o=n.name,c=n.category,u=n.brand,s=n.variant,f=n.position,l=n.price,p=n.quantity,d=n.coupon,g=n.image,m=n.sku,v=C(n,gt);null==i&&null==o||(t[e+"id"]=i,t[e+"nm"]=o,t[e+"br"]=u,t[e+"ca"]=c,t[e+"va"]=s,t[e+"pr"]=ht(l),t[e+"qt"]=p,t[e+"cc"]=d,t[e+"ps"]=ht(f),t[e+"img"]=g,t[e+"sku"]=m,a(v).forEach((function(n){var r;if(0===n.indexOf("dimension")&&(r="cd"),0===n.indexOf("metric")&&(r="cm"),r){var i=ot(n);t[e+r+i]=v[n]}})),(r||{}).imageIndex&&(t[e+"cd"+r.imageIndex]=g))}},{key:"getEcPurchaseData",value:function getEcPurchaseData(e,t,n){if(e||t){var r,i=e||t,o=i.actionField,a=i.products,c=o||{},u=c.id,s=c.affiliation,f=c.revenue,l=c.tax,p=c.shipping,d=c.coupon;return r=e?{pa:"purchase",ti:u,ta:s,tr:ht(f),tt:ht(l),ts:ht(p),tcc:d}:{pa:"refund",ti:u},a&&(r=_objectSpread2(_objectSpread2({},r),this.getProductsData(a,n))),r}}},{key:"getEcStepData",value:function getEcStepData(e,t,n){if(e||t){var r=e||t,i=r.actionField,o=r.products,a=i||{};return _objectSpread2({cos:a.step,col:a.option,pa:t?"checkout_option":"checkout"},this.getProductsData(o,n))}}},{key:"getEcActionData",value:function getEcActionData(e,t,n){if(e){var r=e.actionField,i=e.products,o=(r||{}).list,a=_objectSpread2(_objectSpread2({},this.getProductsData(i,n)),{},{pa:t,pal:o});return ce(a,!0)}}},{key:"getEcImpressionsData",value:function getEcImpressionsData(e,t){var n=this;if(vt(e)){var r=1,i={},o={};return e.forEach((function(e){var a=e.list,c=C(e,mt);i[a]||(i[a]={key:"il"+r,n:1},r++,o[i[a].key+"nm"]=a);var u=i[a].key+"pi"+i[a].n;i[a].n++,n.setOneProduct(u,o,c,t)})),o}}},{key:"getEcData",value:function getEcData(e){var t=(e||{}).ecommerce;if(t){var n=t.impressions,r=t.detail,i=t.click,o=t.add,a=t.remove,c=t.checkout,u=t.checkout_option,s=t.purchase,f=t.refund,l=t.promoView,p=t.promoClick,d=t.currencyCode;return _objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2({},this.getEcImpressionsData(n,e)),this.getEcActionData(r,"detail",e)),this.getEcActionData(i,"click",e)),this.getEcActionData(o,"add",e)),this.getEcActionData(a,"remove",e)),this.getEcStepData(c,u,e)),this.getEcPurchaseData(s,f,e)),this.getEcPromotionData(l,p)),{},{cu:null!=d?d:Be()})}}},{key:"getMp",value:function getMp(e,t){var n=M(),r=N(),i=r.navigator||{},o=r.screen||{},a=n.documentElement||{},c=Math.max(a.clientWidth||0,r.innerWidth||0),u=Math.max(a.clientHeight||0,r.innerHeight||0),s=e||{},f=s.trackingId,l=s.needTrackingId,p=s.version;if(l&&null==f)return!1;var g=t||{},v=g.trigger,h=(g.trackingType,g.bCookieIndex),y=g.bCookie,_=g.lazeInfoIndex,b=g.lazeInfo,S=g.expId,k=g.expVar,w=g.siteId,I=g.email,j=g.p,O=g.p2,x=g.p3,E=g.p4,C=g.p5,D=_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2({},this.getActionData(t)),this.getEcData(t)),this.getReferrer()),{},{siteid:w,em:I,xid:S,xvar:k,fbp:st("_fbp")||undefined,fbc:st("_fbc")||undefined,cg1:j,cg2:O,cg3:x,cg4:E,cg5:C,_s:re,dl:lt(),ul:(i.language||i.browserLanguage||"").toLowerCase(),de:n.characterSet||n.charset,dt:n.title,sd:o.colorDepth+"-bit",sr:o.width+"x"+o.height,vp:c+"x"+u,je:rt(A(i.javaEnabled,null,i)),tid:f,cid:dt(),scid:Fe(),dh:Re(),_gid:pt("_gid"),v:p||1,z:ie,t:"impression"===v?"pageview":"event"});if(re++,"Error"===D.ec&&(D.t="exception",D.exd=D.ea),y&&(h&&(D["cd"+h]=y),D.uid=y),b){_&&(D["cd"+_]=b);var P=function parseJson(e){try{return Q.parse(e)}catch(t){$(t,"I13nScriptErr")}}(b);if(P.time){var T=d(P.time);isNaN(T)||(D.qt=d()-T)}}return m&&(D.clt=d()-m),ce(D,!0)}}]),DataLayerToMp}();!function resetSeq(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;re=e,ie=g()}();var _t,bt=yt,St=function req(e,t,n,r){var i=function createCORSRequest(e,t){var n=N()||self;e=e||"GET";var r=null!=n.XMLHttpRequest?new n.XMLHttpRequest:null;return r&&"withCredentials"in r?r.open(e,t,!0):null!=n.XDomainRequest?(r=new n.XDomainRequest).open(e,t):r=null,r}(n,e);if(!i)return!1;i.timeout=3e4,i.onload=function(){_t=!0,A(A(t,[i]))};try{return i.send(r),!0}catch(o){return console.warn("req failed.",{url:e,e:o}),!1}},kt=function imageTag(e){if(!function hasWin(e){return!N()[e||"__null"]}())return St(e);var t,n=new Image;n.onload=function(){t&&clearTimeout(t),_t=!0},n.src=e,t=setTimeout((function(){n.src=""}),9e4)},wt=function beacon(e,t,n,r){n=n||St,r=r||kt;var i=function dataToQuery(e){var t="?";return e?(a(e).forEach((function(n){t=function setUrl(e,t,n,r){var i=c(t);return n=function unsetUrl(e,t){t=De(t);for(var n,r=getKeyReg(e);n=r.exec(t);)t="?"===n[2]?t.replace(r,"?"):t.replace(r,"");return t}(e,De(n)),(i?t:[t]).forEach((function(t){r||(t=encodeURIComponent(t)),n=n+(-1===n.indexOf("?")?"?":"&")+e+"="+t})),n}(n,e[n],t)})),t.substring(2)):t}(t),o=e+"?"+i;2036>=o.length?r(o):function beaconApi(e,t){var n=j(N(),["navigator","sendBeacon"]);return!(!n||!_t||(n.call(N().navigator,e,t),0))}(e,i)||n(e,null,"POST",i)||r(o)},It=function mpTag(e){var t=e.store,n=e.gaId,r=e.bCookieIndex,i=e.lazeInfoIndex,o=e.mpHost,c=new bt,u=function push(e){var u,s=t.getState(),f=function getUserId(){var e,t;return null!==(e=null==ee||null===(t=ee.getState())||void 0===t?void 0:t.get("uid"))&&void 0!==e?e:He()}();f&&(e.bCookie=f,r&&(e.bCookieIndex=r)),e.lazeInfo&&i&&(e.lazeInfoIndex=i),"action"===e.trigger&&(e.label=function mergeGaLabel(e,t){var n=e;return a(t||{}).length&&(n="object"!==b(n)?_objectSpread2({label:e},t):_objectSpread2(_objectSpread2({},n),t)),"object"===b(n)&&(n=JSON.stringify(n)),n}(e.label,e.ecommerce?{ecommerce:e.ecommerce}:null)),e.p=null!==(u=e.p)&&void 0!==u?u:Ue(),e.expId=s.get("expId"),e.expVar=s.get("expVar"),e.siteId=s.get("siteId"),e.email=s.get("email"),e.gaId=n||s.get("trackingId"),function doPush(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:wt,r=t.getState(),i=A(o)||r.get("mpHost"),a=r.get("defaultMpHost"),u=i||a;if(u){var s=c.getMp({trackingId:e.gaId,needTrackingId:r.get("needTrackingId"),version:r.get("version")},e);s&&n(u,s)}else console.warn("mp host not found")}(ce(e))};!function regTag(e){return function(t){var n=t.init,r=t.action,i=t.impression;n&&e.addListener(be(n,"init")),r&&e.addListener(be(r,"action")),i&&e.addListener(be(i,"impression"))}}(t)({action:function action(){var e=t.getClone("I13N"),n=e.lazeInfo,action=e.action,r=e.category,i=e.label,o=e.value,a=e.p,c=e.p2,s=e.p3,f=e.p4,l=e.p5,p={trigger:"action",lazeInfo:JSON.stringify(n),action:action,category:null!=r?r:action,label:i,value:o,p:a,p2:c,p3:s,p4:f,p5:l};u(tt(p,e,t))},impression:function impression(){var e=t.getClone("i13nPage"),n=e.p,r=e.p2,i=e.p3,o=e.p4,a=e.p5;u(tt({trigger:"impression",p:n,p2:r,p3:i,p4:o,p5:a},e,t))}})},jt=function getTag(e){e.store=ee,e.type,It(e)},At=function initHandler(e,t,n){var r=O(t);return function initTags(e){for(var t=j(e,["tags"],[]),n=t.length;n--;)jt(t[n])}(_objectSpread2(_objectSpread2({},j(e)),r)),t.asyncInit=!0,n(ne(e,r),t)},Ot=function impressionHandler(e,t){return de(e)};!function init(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},n=t.global,r=void 0===n?{}:n,i=t.globalKey,o=void 0===i?"i13n":i,a=t.utils,c=void 0===a?ge:a,u=!1,s=function run(){u||(r[o]=A(c),u=!0,te("reset",{initHandler:At,actionHandler:_e,impressionHandler:Ot}),te("impression",{trackingId:e,tags:[{mpHost:me}]}))};s()}(function getScriptTagId(){var e=M().currentScript;if(e)return Pe("id",e.src)}(),{global:N()})}]);