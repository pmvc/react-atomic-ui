{"version":3,"file":"vendor.b8c3ae8df916d220a323.hot-update.js","sources":["webpack:///./node_modules/organism-react-iframe/build/es/ui/organisms/Iframe.js","webpack:///./node_modules/organism-react-iframe/build/es/ui/organisms/IframeContainer.js"],"sourcesContent":["import _objectWithoutProperties from \"reshow-runtime/es/helpers/objectWithoutProperties\";\nimport _extends from \"reshow-runtime/es/helpers/extends\";\nimport _classCallCheck from \"reshow-runtime/es/helpers/classCallCheck\";\nimport _createClass from \"reshow-runtime/es/helpers/createClass\";\nimport _assertThisInitialized from \"reshow-runtime/es/helpers/assertThisInitialized\";\nimport _inherits from \"reshow-runtime/es/helpers/inherits\";\nimport _possibleConstructorReturn from \"reshow-runtime/es/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"reshow-runtime/es/helpers/getPrototypeOf\";\nimport _defineProperty from \"reshow-runtime/es/helpers/defineProperty\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { PureComponent, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport get from \"get-object-value\";\nimport getOffset from \"getoffset\";\nimport smoothScrollTo from \"smooth-scroll-to\";\nimport exec from \"exec-script\";\nimport { SemanticUI, Unsafe } from \"react-atomic-molecule\";\nimport { queryFrom } from \"css-query-selector\";\nimport callfunc from \"call-func\";\nimport IframeContainer from \"../organisms/IframeContainer\";\nvar keys = Object.keys;\n\nvar IframeInner = function IframeInner(_ref) {\n  var children = _ref.children,\n      inlineCSS = _ref.inlineCSS,\n      onLoad = _ref.onLoad;\n  useEffect(function () {\n    callfunc(onLoad);\n  }, [children]);\n  return /*#__PURE__*/React.createElement(SemanticUI, null, /*#__PURE__*/React.createElement(Unsafe, {\n    atom: \"style\"\n  }, function () {\n    return inlineCSS || \"body {padding: 0; margin: 0; background: transparent;}\";\n  }), children);\n};\n\nvar Iframe = /*#__PURE__*/function (_PureComponent) {\n  _inherits(Iframe, _PureComponent);\n\n  var _super = _createSuper(Iframe);\n\n  function Iframe() {\n    var _this;\n\n    _classCallCheck(this, Iframe);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"html\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"execStop\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"appendHtml\", function (html) {\n      var div = document.createElement(\"div\");\n      div.innerHTML = html;\n      var root = get(_this.root, [\"childNodes\", 0, \"childNodes\", 0], _this.root);\n      root.appendChild(div);\n\n      _this.handleScript(div);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"postHeight\", function () {\n      return _this.iframe.postHeight(_this.getWindow());\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"scrollToEl\", function (el) {\n      var pos = getOffset(el);\n\n      if (pos.rect) {\n        smoothScrollTo(pos.rect.top);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getBody\", function () {\n      return get(_this.getDoc(), [\"body\"]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getDoc\", function () {\n      return get(_this.getWindow(), [\"document\"]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getWindow\", function () {\n      return get(_this.el, [\"contentWindow\", \"window\"]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleBodyClick\", function (e) {\n      var _this$props = _this.props,\n          keepTargetInIframe = _this$props.keepTargetInIframe,\n          disableSmoothScroll = _this$props.disableSmoothScroll,\n          onLinkClick = _this$props.onLinkClick;\n      var query = queryFrom(function () {\n        return _this.getBody();\n      });\n      var evTarget = e.target;\n      var link = evTarget.nodeName === \"A\" ? evTarget : query.ancestor(evTarget, \"a\");\n\n      if (!link) {\n        return;\n      }\n\n      if (link.target && \"_blank\" === link.target.toLowerCase()) {\n        return;\n      }\n\n      var isContinue = callfunc(onLinkClick, [e, link]);\n\n      if (false === isContinue) {\n        e.preventDefault();\n        return;\n      }\n\n      if (link.hash && !disableSmoothScroll) {\n        var tarDom;\n\n        try {\n          tarDom = query.one(link.hash);\n        } catch (e) {\n          var tarId = decodeURIComponent(link.hash.substr(1));\n          tarDom = query.one(\"[id=\\\"\".concat(tarId, \"\\\"]\")) || query.one(\"[name=\\\"\".concat(tarId, \"\\\"]\"));\n        }\n\n        if (!tarDom) {\n          console.warn(\"Can not handle hash\", {\n            e: e\n          });\n          return;\n        } else {\n          var URI = document.location;\n\n          if (URI.pathname === link.pathname && URI.host === link.host) {\n            e.preventDefault();\n\n            _this.scrollToEl(tarDom);\n\n            return;\n          }\n        }\n      }\n\n      if (keepTargetInIframe) {\n        return;\n      } else {\n        e.preventDefault();\n\n        if (link.href) {\n          location.href = link.href;\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleScript\", function (el) {\n      var win = _this.getWindow();\n\n      if (win) {\n        _this.execStop = exec(el, win, _this.root.parentNode, function (e, script) {\n          console.warn('script error', [e, script]);\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleRef\", function (el) {\n      return _this.iframe = el;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleRefCb\", function (el) {\n      if (el) {\n        var refCb = _this.props.refCb;\n        _this.el = el;\n        callfunc(refCb, [el]);\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Iframe, [{\n    key: \"handleLinkClick\",\n    value: function handleLinkClick() {\n      var body = this.getBody();\n\n      if (!body) {\n        return;\n      }\n\n      body.removeEventListener(\"click\", this.handleBodyClick);\n      body.addEventListener(\"click\", this.handleBodyClick);\n    }\n  }, {\n    key: \"renderIframe\",\n    value: function renderIframe(props) {\n      var _this2 = this;\n\n      if (!this.root) {\n        this.init();\n      }\n\n      var root = this.root;\n      var children = props.children,\n          autoHeight = props.autoHeight,\n          onLoadDelay = props.onLoadDelay,\n          onLoad = props.onLoad,\n          inlineCSS = props.inlineCSS;\n      this.html = root.innerHTML;\n\n      var callback = function callback() {\n        if (!_this2._mount) {\n          return;\n        }\n\n        var html = root.innerHTML;\n\n        if (html !== _this2.html) {\n          _this2.handleScript(root);\n\n          _this2.handleLinkClick();\n\n          _this2.onLoadTimer = setTimeout(function () {\n            if (!_this2._mount || !_this2.getWindow()) {\n              return;\n            }\n\n            if (autoHeight) {\n              _this2.postHeight();\n            }\n\n            callfunc(onLoad);\n          }, onLoadDelay);\n        }\n      };\n\n      return /*#__PURE__*/createPortal( /*#__PURE__*/React.createElement(IframeInner, _extends({}, props, {\n        inlineCSS: inlineCSS,\n        onLoad: callback\n      })), this.root);\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      var _this$props2 = this.props,\n          initialContent = _this$props2.initialContent,\n          onUnload = _this$props2.onUnload,\n          onBeforeUnload = _this$props2.onBeforeUnload,\n          autoHeight = _this$props2.autoHeight;\n      this.root = document.createElement(\"div\");\n      var doc = this.getDoc();\n\n      if (doc) {\n        // fixed firfox innerHTML suddenly disappear.\n        doc.open(\"text/html\", \"replace\");\n        doc.write(initialContent);\n        doc.close();\n        var body = this.getBody();\n        body.appendChild(this.root);\n        body.addEventListener(\"unload\", onUnload);\n        body.addEventListener(\"beforeunload\", onBeforeUnload);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      !this.root && this.forceUpdate();\n      this._mount = true;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._mount = false;\n\n      if (this.onLoadTimer) {\n        clearTimeout(this.onLoadTimer);\n      }\n\n      callfunc(this.execStop);\n      callfunc(this.props.onUnmount);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          inlineCSS = _this$props3.inlineCSS,\n          initialContent = _this$props3.initialContent,\n          children = _this$props3.children,\n          keepTargetInIframe = _this$props3.keepTargetInIframe,\n          disableSmoothScroll = _this$props3.disableSmoothScroll,\n          refCb = _this$props3.refCb,\n          autoHeight = _this$props3.autoHeight,\n          onLinkClick = _this$props3.onLinkClick,\n          onLoad = _this$props3.onLoad,\n          onLoadDelay = _this$props3.onLoadDelay,\n          onUnload = _this$props3.onUnload,\n          onBeforeUnload = _this$props3.onBeforeUnload,\n          onUnmount = _this$props3.onUnmount,\n          others = _objectWithoutProperties(_this$props3, [\"inlineCSS\", \"initialContent\", \"children\", \"keepTargetInIframe\", \"disableSmoothScroll\", \"refCb\", \"autoHeight\", \"onLinkClick\", \"onLoad\", \"onLoadDelay\", \"onUnload\", \"onBeforeUnload\", \"onUnmount\"]);\n\n      if (autoHeight) {\n        others.scrolling = \"no\";\n      }\n\n      return /*#__PURE__*/React.createElement(IframeContainer, _extends({}, others, {\n        ref: this.handleRef,\n        refCb: this.handleRefCb\n      }), this.el && this.renderIframe(this.props));\n    }\n  }]);\n\n  return Iframe;\n}(PureComponent);\n\n_defineProperty(Iframe, \"defaultProps\", {\n  disableSmoothScroll: false,\n  keepTargetInIframe: false,\n  initialContent: \"<html><body /></html>\",\n  autoHeight: false,\n  onLoadDelay: 500\n});\n\nexport default Iframe;","import _extends from \"reshow-runtime/es/helpers/extends\";\nimport _objectSpread from \"reshow-runtime/es/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"reshow-runtime/es/helpers/objectWithoutProperties\";\nimport _classCallCheck from \"reshow-runtime/es/helpers/classCallCheck\";\nimport _createClass from \"reshow-runtime/es/helpers/createClass\";\nimport _assertThisInitialized from \"reshow-runtime/es/helpers/assertThisInitialized\";\nimport _inherits from \"reshow-runtime/es/helpers/inherits\";\nimport _possibleConstructorReturn from \"reshow-runtime/es/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"reshow-runtime/es/helpers/getPrototypeOf\";\nimport _defineProperty from \"reshow-runtime/es/helpers/defineProperty\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { PureComponent } from \"react\";\nimport get from \"get-object-value\";\nimport { SemanticUI } from \"react-atomic-molecule\";\nimport callfunc from \"call-func\";\nvar iframeCount = 0;\n\nvar IframeContainer = /*#__PURE__*/function (_PureComponent) {\n  _inherits(IframeContainer, _PureComponent);\n\n  var _super = _createSuper(IframeContainer);\n\n  function IframeContainer(props) {\n    var _this;\n\n    _classCallCheck(this, IframeContainer);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      iframeH: \"auto\"\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"postHeight\", function (win) {\n      _this.setState({\n        iframeH: \"auto\"\n      }, function () {\n        setTimeout(function () {\n          var _win$parent;\n\n          win === null || win === void 0 ? void 0 : (_win$parent = win.parent) === null || _win$parent === void 0 ? void 0 : _win$parent.window.postMessage({\n            type: _this.messageKey,\n            h: win.document.body.offsetHeight\n          }, \"*\");\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleMessage\", function (e) {\n      var data = e.data;\n\n      if (\"string\" === typeof data) {\n        try {\n          data = JSON.parse(get(data, null, \"{}\"));\n        } catch (ex) {}\n      }\n\n      var _data = data,\n          type = _data.type,\n          h = _data.h;\n\n      if (-1 !== \"|\".concat(type, \"|\").indexOf(\"|\".concat(_this.messageKey, \"|\"))) {\n        _this.setState({\n          iframeH: h + 50\n        });\n      }\n    });\n\n    var messageKey = props.messageKey;\n    _this.messageKey = messageKey + \"-\" + iframeCount;\n    iframeCount++;\n    return _this;\n  }\n\n  _createClass(IframeContainer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener(\"message\", this.handleMessage, false);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener(\"message\", this.handleMessage, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var iframeH = this.state.iframeH;\n\n      var _this$props = this.props,\n          src = _this$props.src,\n          _refCb = _this$props.refCb,\n          style = _this$props.style,\n          messageKey = _this$props.messageKey,\n          others = _objectWithoutProperties(_this$props, [\"src\", \"refCb\", \"style\", \"messageKey\"]);\n\n      if (src) {\n        others.src = src;\n      }\n\n      return /*#__PURE__*/React.createElement(SemanticUI, _extends({}, others, {\n        style: _objectSpread(_objectSpread({}, Styles.iframe), {}, {\n          height: iframeH,\n          minHeight: iframeH\n        }, style),\n        atom: \"iframe\",\n        refCb: function refCb(el) {\n          if (el) {\n            _this2.iframe = el;\n            callfunc(_refCb, [el]);\n          }\n        }\n      }));\n    }\n  }]);\n\n  return IframeContainer;\n}(PureComponent);\n\n_defineProperty(IframeContainer, \"defaultProps\", {\n  messageKey: \"iframeH\"\n});\n\nexport default IframeContainer;\nvar Styles = {\n  iframe: {\n    width: \"100%\",\n    border: 0\n  }\n};"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}